<script src="http://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.6.3/coffee-script.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>

<link rel="stylesheet" href="../dist/doodad.css">
<script src="../dist/doodad.js"></script>

<style>
    .example_code {
        white-space: pre;
        font-family: Menlo, monospace;
        font-size: 14px;
        display: block;
    }
</style>

<h1>Doodad.Popover</h1>

<div class="example">
    <h2>Basic popover (flag-type, top-left origin)</h2>
    <script type="text/coffeescript" class="example_code">
        popover = new Doodad.Popover
            content: [
                new Doodad.Button
                    label: 'Do Stuff'
                    spinner: true
                    action: (self) ->
                        setTimeout ->
                            self.enable()
                        , 1000
                new Doodad.Button
                    label: 'Do Stuff Then Close'
                    spinner: true
                    action: (self) ->
                        setTimeout ->
                            self.enable()
                            popover.hide()
                        , 1000
            ]
        button = new Doodad.Button
            label: 'Show Flag Popover'
            action: popover.toggle
            class: 'warning'
        doodads.push(button)
    </script>
</div>


<div class="example">
    <h2>Basic popover (flag-type, a little shy)</h2>
    <script type="text/coffeescript" class="example_code">
        popover = new Doodad.Popover
            type: 'flag'
            origin: 'left-top'
            close_on_outside: true
            content: [
                new Doodad.Button
                    label: 'Do Stuff'
                    spinner: true
                    action: (self) ->
                        setTimeout ->
                            self.enable()
                        , 1000
                new Doodad.Button
                    label: 'Do Stuff Then Close'
                    spinner: true
                    action: (self) ->
                        setTimeout ->
                            self.enable()
                            popover.hide()
                        , 1000
            ]
        button = new Doodad.Button
            label: 'Show Flag Popover'
            action: popover.toggle
            class: 'warning'
        doodads.push(button)
    </script>
</div>


<div class="example">
    <h2>Modal popover</h2>
    <script type="text/coffeescript" class="example_code">
        modal = new Doodad.Popover
            type: 'modal'
            content: [
                new Doodad.Tags.P
                    content: 'Some filler text and stuff.'
                new Doodad.Button
                    label: 'Close Modal'
                    action: ->
                        modal.hide()
            ]
        button = new Doodad.Button
            label: 'Show Modal'
            action: modal.toggle
        doodads.push(button)
    </script>
</div>


<div class="example">
    <h2>Confirm or dismiss popover</h2>
    <script type="text/coffeescript" class="example_code">
        select = new Doodad.Select
            required: true
            action: ->
            css:
                'z-index': 3
            choices: [
                {
                    label: 'Choice 1'
                    value: 'choice-1'
                }
                {
                    label: 'Choice 2'
                    value: 'choice-2'
                }
                {
                    label: 'Choice 3'
                    value: 'choice-3'
                }
            ]
        modal = new Doodad.Popover
            type: 'modal'
            title: 'I am dismissable'
            css:
                'z-index': 2
            content: [
                select,
                new Doodad.Tags.P
                    content: 'Some filler text and stuff.'
            ]
            confirm: 'Okay'
            dismiss: 'Nevermind'
        button = new Doodad.Button
            label: 'Show Modal'
            action: modal.toggle
        status = new Doodad.Tags.P()
        modal.on 'dismiss', ->
            status.setContent('Dismissed')
        modal.on 'confirm', ->
            status.setContent("Confirmed - #{ select.value }")
        window.X = status
        doodads.push([button, status])
    </script>
</div>







<script>
    window.doodads = [];
</script>

<script type="text/coffeescript">
    examples = $('.example')
    examples.find('h2').after """
        <div class="example_app">
            <div class="output"></div>
        </div>
    """
    _.each doodads, (doodad_set, i) ->
        console.log doodad_set, i
        $example_el = $(examples[i])
        unless _.isArray(doodad_set)
            doodad_set = [doodad_set]
        _.each doodad_set, (doodad_instance) ->
            # Add the doodad_instance to the DOM
            $example_el.find('.example_app').prepend(doodad_instance.render())



</script>